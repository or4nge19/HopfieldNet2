<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href=".././style.css"></link><link rel="icon" href=".././favicon.svg"></link><link rel="mask-icon" href=".././favicon.svg" color="#000000"></link><link rel="prefetch" href=".././/declarations/declaration-data.bmp" as="image"></link><title>HopfieldNet.Markov</title><script defer="true" src=".././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT=".././";</script><script>const MODULE_NAME="HopfieldNet.Markov";</script><script type="module" src=".././jump-src.js"></script><script type="module" src=".././search.js"></script><script type="module" src=".././expand-nav.js"></script><script type="module" src=".././how-about.js"></script><script type="module" src=".././instances.js"></script><script type="module" src=".././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">HopfieldNet</span>.<span class="name">Markov</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href=".././Init.html">Init</a></li><li><a href=".././HopfieldNet/Stochastic.html">HopfieldNet.Stochastic</a></li><li><a href=".././Mathlib/Analysis/BoundedVariation.html">Mathlib.Analysis.BoundedVariation</a></li><li><a href=".././Mathlib/MeasureTheory/Measure/WithDensity.html">Mathlib.MeasureTheory.Measure.WithDensity</a></li><li><a href=".././Mathlib/Probability/Kernel/Basic.html">Mathlib.Probability.Kernel.Basic</a></li><li><a href=".././Mathlib/Probability/Kernel/Invariance.html">Mathlib.Probability.Kernel.Invariance</a></li><li><a href=".././Mathlib/Probability/Kernel/Composition/MeasureComp.html">Mathlib.Probability.Kernel.Composition.MeasureComp</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-HopfieldNet.Markov" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#ProbabilityTheory.Kernel.pow"><span class="name">ProbabilityTheory</span>.<span class="name">Kernel</span>.<span class="name">pow</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.instMeasurableSpaceStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instMeasurableSpaceStateHopfieldNetwork</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.measurableSet_discrete"><span class="name">MarkovChain</span>.<span class="name">measurableSet_discrete</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.instDiscreteMeasurableSpaceStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instDiscreteMeasurableSpaceStateHopfieldNetwork</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.StationaryDistribution"><span class="name">MarkovChain</span>.<span class="name">StationaryDistribution</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.DetailedBalance"><span class="name">MarkovChain</span>.<span class="name">DetailedBalance</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.stationaryOfDetailedBalance"><span class="name">MarkovChain</span>.<span class="name">stationaryOfDetailedBalance</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.instNonemptyStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instNonemptyStateHopfieldNetwork</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.instFintypeStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instFintypeStateHopfieldNetwork</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.gibbsTransitionKernel"><span class="name">MarkovChain</span>.<span class="name">gibbsTransitionKernel</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.gibbsIsMarkovKernel"><span class="name">MarkovChain</span>.<span class="name">gibbsIsMarkovKernel</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.stochasticHopfieldMarkovProcess"><span class="name">MarkovChain</span>.<span class="name">stochasticHopfieldMarkovProcess</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.nStepTransition"><span class="name">MarkovChain</span>.<span class="name">nStepTransition</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.totalVariation"><span class="name">MarkovChain</span>.<span class="name">totalVariation</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.IsAperiodic"><span class="name">MarkovChain</span>.<span class="name">IsAperiodic</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.IsIrreducible"><span class="name">MarkovChain</span>.<span class="name">IsIrreducible</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDensityFn"><span class="name">MarkovChain</span>.<span class="name">boltzmannDensityFn</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannPartitionFn"><span class="name">MarkovChain</span>.<span class="name">boltzmannPartitionFn</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannPartitionFn_pos_finite"><span class="name">MarkovChain</span>.<span class="name">boltzmannPartitionFn_pos_finite</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_def_of_pos_finite"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_def_of_pos_finite</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_measure_univ"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_measure_univ</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_integral_eq_sum"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_integral_eq_sum</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_div_sum"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_div_sum</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_sum_one"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_sum_one</span></a></div><div class="nav_link"><a class="break_within" href="#MarkovChain.boltzmannDistribution_isProbability"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_isProbability</span></a></div></nav><main>
<div class="decl" id="ProbabilityTheory.Kernel.pow"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L12-L15">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow"><span class="name">ProbabilityTheory</span>.<span class="name">Kernel</span>.<span class="name">pow</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">κ</span> : <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">Kernel</a> <span class="fn">α</span> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nat">ℕ</a> → <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">Kernel</a> <span class="fn">α</span> <span class="fn">α</span></span></span></div></div><p><code><a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">Kernel.pow</a> κ n</code> is the <code>n</code>-fold composition of the kernel <code>κ</code>, with <code><a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a> κ 0 = <a href=".././Init/Prelude.html#id">id</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">κ</span>.<a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a></span> <span class="fn">0</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Mathlib/Probability/Kernel/Basic.html#ProbabilityTheory.Kernel.id">ProbabilityTheory.Kernel.id</a></li><li class="equation"><span class="fn"><span class="fn"><span class="fn">κ</span>.<a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a></span> <span class="fn"><span class="fn">n</span>.<a href=".././Init/Prelude.html#Nat.succ">succ</a></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">κ</span>.<a href=".././Mathlib/Probability/Kernel/Composition/Comp.html#ProbabilityTheory.Kernel.comp">comp</a></span> <span class="fn">(<span class="fn"><span class="fn">κ</span>.<a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a></span> <span class="fn">n</span>)</span></span></li></ul></details><details id="instances-for-list-ProbabilityTheory.Kernel.pow" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h1 class="markdown-heading" id="Markov-Chain-Framework">Markov Chain Framework <a class="hover-link" href="#Markov-Chain-Framework">#</a></h1><h2 class="markdown-heading" id="Main-definitions">Main definitions <a class="hover-link" href="#Main-definitions">#</a></h2><ul>
<li><code><a href=".././HopfieldNet/Markov.html#MarkovChain.stochasticHopfieldMarkovProcess">stochasticHopfieldMarkovProcess</a></code>: A Markov process on Hopfield network states</li>
<li><code><a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">gibbsTransitionKernel</a></code>: The transition kernel for Gibbs sampling</li>
<li><code><a href=".././HopfieldNet/Markov.html#MarkovChain.DetailedBalance">DetailedBalance</a></code>: The detailed balance condition for reversible Markov chains</li>
<li><code>mixingTime</code>: The time needed to approach the stationary distribution (TODO)</li>
</ul></div><div class="decl" id="MarkovChain.instMeasurableSpaceStateHopfieldNetwork"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L36-L37">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.instMeasurableSpaceStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instMeasurableSpaceStateHopfieldNetwork</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.instMeasurableSpaceStateHopfieldNetwork">MarkovChain.instMeasurableSpaceStateHopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a></li></ul></details></div></div><div class="decl" id="MarkovChain.measurableSet_discrete"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L40-L42">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.measurableSet_discrete"><span class="name">MarkovChain</span>.<span class="name">measurableSet_discrete</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">inst✝</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href=".././Mathlib/Data/Set/Defs.html#Set">Set</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSet">MeasurableSet</a> <span class="fn">s</span></span></div></div></div></div><div class="decl" id="MarkovChain.instDiscreteMeasurableSpaceStateHopfieldNetwork"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L44-L46">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.instDiscreteMeasurableSpaceStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instDiscreteMeasurableSpaceStateHopfieldNetwork</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#DiscreteMeasurableSpace">DiscreteMeasurableSpace</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div></div></div><div class="mod_doc"><h3 class="markdown-heading" id="Core-Markov-Chain-Definitions">Core Markov Chain Definitions <a class="hover-link" href="#Core-Markov-Chain-Definitions">#</a></h3></div><div class="decl" id="MarkovChain.StationaryDistribution"><div class="structure"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L52-L62">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution"><span class="name">MarkovChain</span>.<span class="name">StationaryDistribution</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">K</span> : <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">ProbabilityTheory.Kernel</a> <span class="fn">α</span> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a> u_1</div></div><p>A <code><a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution">StationaryDistribution</a></code> for a transition kernel is a measure that remains
invariant under the action of the kernel.</p><ul class="structure_fields" id="MarkovChain.StationaryDistribution.mk"><li id="MarkovChain.StationaryDistribution.measure" class="structure_field"><div class="structure_field_info">measure : <span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/MeasureSpaceDef.html#MeasureTheory.Measure">MeasureTheory.Measure</a> <span class="fn">α</span></span></div><div class="structure_field_doc"><p>The probability measure that is stationary with respect to the kernel K.</p></div></li><li id="MarkovChain.StationaryDistribution.isProbability" class="structure_field"><div class="structure_field_info">isProbability : <span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/Typeclasses/Probability.html#MeasureTheory.IsProbabilityMeasure">MeasureTheory.IsProbabilityMeasure</a> <span class="fn"><span class="fn">self</span>.<a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution.measure">measure</a></span></span></div><div class="structure_field_doc"><p>Proof that the measure is a probability measure (sums to 1).</p></div></li><li id="MarkovChain.StationaryDistribution.isStationary" class="structure_field"><div class="structure_field_info">isStationary<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href=".././Mathlib/Data/Set/Defs.html#Set">Set</a> <span class="fn">α</span></span>)</span></span>
 : <span class="fn"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSet">MeasurableSet</a> <span class="fn">s</span></span> → <span class="fn"><span class="fn">(<span class="fn"><span class="fn"><span class="fn">self</span>.<a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution.measure">measure</a></span>.<a href=".././Mathlib/MeasureTheory/Measure/GiryMonad.html#MeasureTheory.Measure.bind">bind</a></span> <span class="fn">⇑<span class="fn">K</span></span>)</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">self</span>.<a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution.measure">measure</a></span> <span class="fn">s</span></span></span></div><div class="structure_field_doc"><p>Proof that the measure is invariant under the kernel K.</p></div></li></ul><details id="instances-for-list-MarkovChain.StationaryDistribution" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.DetailedBalance"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L64-L70">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.DetailedBalance"><span class="name">MarkovChain</span>.<span class="name">DetailedBalance</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">μ</span> : <span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/MeasureSpaceDef.html#MeasureTheory.Measure">MeasureTheory.Measure</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">K</span> : <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">ProbabilityTheory.Kernel</a> <span class="fn">α</span> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Prop</a></div></div><p>The detailed balance condition for a Markov kernel with respect to a measure.
<code>μ(dx) K(x,dy) = μ(dy) K(y,dx)</code> for all measurable sets</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.DetailedBalance">MarkovChain.DetailedBalance</a> <span class="fn">μ</span> <span class="fn">K</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">∀ (<span class="fn">A </span><span class="fn">B</span> : <span class="fn"><a href=".././Mathlib/Data/Set/Defs.html#Set">Set</a> <span class="fn">α</span></span>), <span class="fn"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSet">MeasurableSet</a> <span class="fn">A</span></span> → <span class="fn"><span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSet">MeasurableSet</a> <span class="fn">B</span></span> → <span class="fn"><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∫⁻</a> (<span class="fn">x</span> : <span class="fn">α</span>) <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">in</a> <span class="fn">A</span><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">,</a> <span class="fn"><span class="fn">(<span class="fn">K</span> <span class="fn">x</span>)</span> <span class="fn">B</span></span> <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∂</a><span class="fn">μ</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∫⁻</a> (<span class="fn">y</span> : <span class="fn">α</span>) <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">in</a> <span class="fn">B</span><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">,</a> <span class="fn"><span class="fn">(<span class="fn">K</span> <span class="fn">y</span>)</span> <span class="fn">A</span></span> <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∂</a><span class="fn">μ</span></span></span></span></span></li></ul></details><details id="instances-for-list-MarkovChain.DetailedBalance" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.stationaryOfDetailedBalance"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L72-L94">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.stationaryOfDetailedBalance"><span class="name">MarkovChain</span>.<span class="name">stationaryOfDetailedBalance</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a> u_1}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSpace">MeasurableSpace</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">μ</span> : <span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/MeasureSpaceDef.html#MeasureTheory.Measure">MeasureTheory.Measure</a> <span class="fn">α</span></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/Typeclasses/Probability.html#MeasureTheory.IsProbabilityMeasure">MeasureTheory.IsProbabilityMeasure</a> <span class="fn">μ</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">K</span> : <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">ProbabilityTheory.Kernel</a> <span class="fn">α</span> <span class="fn">α</span></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.IsMarkovKernel">ProbabilityTheory.IsMarkovKernel</a> <span class="fn">K</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.DetailedBalance">DetailedBalance</a> <span class="fn">μ</span> <span class="fn">K</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution">StationaryDistribution</a> <span class="fn">K</span></span></div></div><p>When detailed balance holds, the measure is stationary</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.stationaryOfDetailedBalance">MarkovChain.stationaryOfDetailedBalance</a> <span class="fn">h</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution.mk">{</a> <span class="fn">measure</span> := <span class="fn">μ</span>, <span class="fn">isProbability</span> := <span class="fn">⋯</span>, <span class="fn">isStationary</span> := <span class="fn">⋯</span> <a href=".././HopfieldNet/Markov.html#MarkovChain.StationaryDistribution.mk">}</a></li></ul></details><details id="instances-for-list-MarkovChain.stationaryOfDetailedBalance" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h3 class="markdown-heading" id="Markov-Chain-on-Hopfield-Networks">Markov Chain on Hopfield Networks <a class="hover-link" href="#Markov-Chain-on-Hopfield-Networks">#</a></h3></div><div class="decl" id="MarkovChain.instNonemptyStateHopfieldNetwork"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L104-L109">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.instNonemptyStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instNonemptyStateHopfieldNetwork</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div></div></div><div class="decl" id="MarkovChain.instFintypeStateHopfieldNetwork"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L112-L128">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.instFintypeStateHopfieldNetwork"><span class="name">MarkovChain</span>.<span class="name">instFintypeStateHopfieldNetwork</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href=".././HopfieldNet/Markov.html#MarkovChain.instFintypeStateHopfieldNetwork">MarkovChain.instFintypeStateHopfieldNetwork</a> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././HopfieldNet/HN/Core.html#instFintypeStateHopfieldNetwork">instFintypeStateHopfieldNetwork</a></li></ul></details></div></div><div class="decl" id="MarkovChain.gibbsTransitionKernel"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L130-L133">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel"><span class="name">MarkovChain</span>.<span class="name">gibbsTransitionKernel</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">ProbabilityTheory.Kernel</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">MarkovChain.gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel.mk">{</a> <span class="fn">toFun</span> := <span class="fn">fun (<span class="fn">state</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) =&gt; <span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingStep">NN.State.gibbsSamplingStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">state</span>)</span>.<a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF.toMeasure">toMeasure</a></span></span>,
    <span class="fn">measurable'</span> := <span class="fn">⋯</span> <a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel.mk">}</a></li></ul></details><details id="instances-for-list-MarkovChain.gibbsTransitionKernel" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.gibbsIsMarkovKernel"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L136-L141">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.gibbsIsMarkovKernel"><span class="name">MarkovChain</span>.<span class="name">gibbsIsMarkovKernel</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.IsMarkovKernel">ProbabilityTheory.IsMarkovKernel</a> <span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span>)</span></span></div></div></div></div><div class="decl" id="MarkovChain.stochasticHopfieldMarkovProcess"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L143-L150">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.stochasticHopfieldMarkovProcess"><span class="name">MarkovChain</span>.<span class="name">stochasticHopfieldMarkovProcess</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Nat">ℕ</a> → <span class="fn"><a href=".././Mathlib/Probability/Kernel/Defs.html#ProbabilityTheory.Kernel">ProbabilityTheory.Kernel</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></span></div></div><p>The stochastic Hopfield Markov process, which models the evolution of Hopfield network states
over discrete time steps using Gibbs sampling at fixed temperature.
In this simplified model, the transition kernel is time-homogeneous (same for all steps).</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.stochasticHopfieldMarkovProcess">MarkovChain.stochasticHopfieldMarkovProcess</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">x✝</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">MarkovChain.gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span></span></li></ul></details><details id="instances-for-list-MarkovChain.stochasticHopfieldMarkovProcess" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.nStepTransition"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L152-L158">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.nStepTransition"><span class="name">MarkovChain</span>.<span class="name">nStepTransition</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> → <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> → <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span></div></div><p>The n-step transition probability, which gives the probability of moving from
state x to state y in exactly n steps.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.nStepTransition">MarkovChain.nStepTransition</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">n</span> <span class="fn">x</span> <span class="fn">y</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<span class="fn">(<span class="fn"><span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">MarkovChain.gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span>)</span>.<a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a></span> <span class="fn">n</span>)</span> <span class="fn">x</span>)</span> <a href=".././Init/Core.html#Singleton.singleton">{</a><span class="fn">y</span><a href=".././Init/Core.html#Singleton.singleton">}</a></span></li></ul></details><details id="instances-for-list-MarkovChain.nStepTransition" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.totalVariation"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L160-L166">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.totalVariation"><span class="name">MarkovChain</span>.<span class="name">totalVariation</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">μ </span><span class="fn">ν</span> : <span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/MeasureSpaceDef.html#MeasureTheory.Measure">MeasureTheory.Measure</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></div></div><p>The total variation distance between two probability measures on Hopfield network states.
Defined as supremum of |μ(A) - ν(A)| over all measurable sets A.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.totalVariation">MarkovChain.totalVariation</a> <span class="fn">μ</span> <span class="fn">ν</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">⨆ (<span class="fn">A</span> : <span class="fn"><a href=".././Mathlib/Data/Set/Defs.html#Set">Set</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span>), <span class="fn">⨆ (_ : <span class="fn"><a href=".././Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSet">MeasurableSet</a> <span class="fn">A</span></span>), <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <a href=".././Mathlib/Algebra/Order/Group/Unbundled/Abs.html#abs">|</a><span class="fn"><span class="fn">(<span class="fn">μ</span> <span class="fn">A</span>)</span>.<a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.toReal">toReal</a></span> <a href=".././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><span class="fn">(<span class="fn">ν</span> <span class="fn">A</span>)</span>.<a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.toReal">toReal</a></span><a href=".././Mathlib/Algebra/Order/Group/Unbundled/Abs.html#abs">|</a></span></span></span></li></ul></details><details id="instances-for-list-MarkovChain.totalVariation" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.IsAperiodic"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L168-L172">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.IsAperiodic"><span class="name">MarkovChain</span>.<span class="name">IsAperiodic</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Prop</a></div></div><p>A state is aperiodic if there's a positive probability of returning to it in a single step.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.IsAperiodic">MarkovChain.IsAperiodic</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> (<span class="fn"><span class="fn">(<span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">MarkovChain.gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span>)</span> <span class="fn">s</span>)</span> <a href=".././Init/Core.html#Singleton.singleton">{</a><span class="fn">s</span><a href=".././Init/Core.html#Singleton.singleton">}</a></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span>)</li></ul></details><details id="instances-for-list-MarkovChain.IsAperiodic" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.IsIrreducible"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L174-L179">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.IsIrreducible"><span class="name">MarkovChain</span>.<span class="name">IsIrreducible</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Prop</a></div></div><p>A Markov chain is irreducible if it's possible to get from any state to any other state
with positive probability in some finite number of steps.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.IsIrreducible">MarkovChain.IsIrreducible</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">∀ (<span class="fn">x </span><span class="fn">y</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>), <span class="fn">∃ (<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>), <span class="fn"><span class="fn">(<span class="fn">(<span class="fn"><span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.gibbsTransitionKernel">MarkovChain.gibbsTransitionKernel</a> <span class="fn">wθ</span> <span class="fn">T</span>)</span>.<a href=".././HopfieldNet/Markov.html#ProbabilityTheory.Kernel.pow">pow</a></span> <span class="fn">n</span>)</span> <span class="fn">x</span>)</span> <a href=".././Init/Core.html#Singleton.singleton">{</a><span class="fn">y</span><a href=".././Init/Core.html#Singleton.singleton">}</a></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span></span></span></li></ul></details><details id="instances-for-list-MarkovChain.IsIrreducible" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.boltzmannDensityFn"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L181-L184">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn"><span class="name">MarkovChain</span>.<span class="name">boltzmannDensityFn</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></div></div><p>The unnormalized Boltzmann density function</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">MarkovChain.boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.E">NeuralNetwork.State.E</a> <span class="fn">wθ</span> <span class="fn">s</span>)</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></li></ul></details><details id="instances-for-list-MarkovChain.boltzmannDensityFn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.boltzmannPartitionFn"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L186-L188">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn"><span class="name">MarkovChain</span>.<span class="name">boltzmannPartitionFn</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></div></div><p>The Boltzmann partition function (normalizing constant)</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">MarkovChain.boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">MarkovChain.boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span></span></li></ul></details><details id="instances-for-list-MarkovChain.boltzmannPartitionFn" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.boltzmannPartitionFn_pos_finite"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L190-L205">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn_pos_finite"><span class="name">MarkovChain</span>.<span class="name">boltzmannPartitionFn_pos_finite</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">_hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">0</span> <a href=".././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#LT.lt">&lt;</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a></div></div><p>The Boltzmann partition function is positive and finite</p></div></div><div class="decl" id="MarkovChain.boltzmannDistribution"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L207-L225">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/MeasureSpaceDef.html#MeasureTheory.Measure">MeasureTheory.Measure</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>The Boltzmann distribution over Hopfield network states at temperature T.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-MarkovChain.boltzmannDistribution" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_def_of_pos_finite"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L228-L235">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_def_of_pos_finite"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_def_of_pos_finite</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution">boltzmannDistribution</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">hT</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">let <span class="fn">densityFn</span> := <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span>;
  <span class="fn">let <span class="fn">partitionFn</span> := <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span>;
  <span class="fn">let <span class="fn">countMeasure</span> := <a href=".././Mathlib/MeasureTheory/Measure/Count.html#MeasureTheory.Measure.count">MeasureTheory.Measure.count</a>;
  <span class="fn"><span class="fn"><span class="fn">countMeasure</span>.<a href=".././Mathlib/MeasureTheory/Measure/WithDensity.html#MeasureTheory.Measure.withDensity">withDensity</a></span> <span class="fn">fun (<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) =&gt; <span class="fn"><span class="fn">densityFn</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">partitionFn</span></span></span></span></span></span></div></div></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_measure_univ"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L237-L242">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_measure_univ"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_measure_univ</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution">boltzmannDistribution</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">hT</span>)</span> <a href=".././Mathlib/Data/Set/Defs.html#Set.univ">Set.univ</a></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∫⁻</a> (<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">in</a> <a href=".././Mathlib/Data/Set/Defs.html#Set.univ">Set.univ</a><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">,</a>     <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∂</a><a href=".././Mathlib/MeasureTheory/Measure/Count.html#MeasureTheory.Measure.count">MeasureTheory.Measure.count</a></span></div></div><p>The Boltzmann distribution measure of the universe equals the integral of density/partition</p></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_integral_eq_sum"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L244-L251">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_integral_eq_sum"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_integral_eq_sum</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">_hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∫⁻</a> (<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">in</a> <a href=".././Mathlib/Data/Set/Defs.html#Set.univ">Set.univ</a><a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">,</a>     <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Mathlib/MeasureTheory/Integral/Lebesgue/Basic.html#MeasureTheory.lintegral">∂</a><a href=".././Mathlib/MeasureTheory/Measure/Count.html#MeasureTheory.Measure.count">MeasureTheory.Measure.count</a></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span></span></div></div><p>The integral over the universe equals the sum over all states</p></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_div_sum"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L253-L265">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_div_sum"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_div_sum</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">(∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span>)</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span></div></div><p>Division can be distributed over the sum in the Boltzmann distribution</p></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_sum_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L268-L273">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_sum_one"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_sum_one</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">(∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDensityFn">boltzmannDensityFn</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span>)</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannPartitionFn">boltzmannPartitionFn</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span></div></div><p>The sum of Boltzmann probabilities equals 1</p></div></div><div class="decl" id="MarkovChain.boltzmannDistribution_isProbability"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Markov.lean#L275-L286">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution_isProbability"><span class="name">MarkovChain</span>.<span class="name">boltzmannDistribution_isProbability</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Monoid/Defs.html#IsOrderedCancelAddMonoid">IsOrderedCancelAddMonoid</a> <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hT</span> : <span class="fn">T</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/MeasureTheory/Measure/Typeclasses/Probability.html#MeasureTheory.IsProbabilityMeasure">MeasureTheory.IsProbabilityMeasure</a> <span class="fn">(<a href=".././HopfieldNet/Markov.html#MarkovChain.boltzmannDistribution">boltzmannDistribution</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">hT</span>)</span></span></div></div><p>Proves that the Boltzmann distribution for a Hopfield network forms a valid probability measure.</p></div></div></main>
<nav class="nav"><iframe src=".././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>