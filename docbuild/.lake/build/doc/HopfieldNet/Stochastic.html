<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href=".././style.css"></link><link rel="icon" href=".././favicon.svg"></link><link rel="mask-icon" href=".././favicon.svg" color="#000000"></link><link rel="prefetch" href=".././/declarations/declaration-data.bmp" as="image"></link><title>HopfieldNet.Stochastic</title><script defer="true" src=".././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT=".././";</script><script>const MODULE_NAME="HopfieldNet.Stochastic";</script><script type="module" src=".././jump-src.js"></script><script type="module" src=".././search.js"></script><script type="module" src=".././expand-nav.js"></script><script type="module" src=".././how-about.js"></script><script type="module" src=".././instances.js"></script><script type="module" src=".././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">HopfieldNet</span>.<span class="name">Stochastic</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href=".././Init.html">Init</a></li><li><a href=".././HopfieldNet/HN/Asym.html">HopfieldNet.HN.Asym</a></li><li><a href=".././Mathlib/Data/Vector/Basic.html">Mathlib.Data.Vector.Basic</a></li><li><a href=".././Mathlib/LinearAlgebra/Matrix/PosDef.html">Mathlib.LinearAlgebra.Matrix.PosDef</a></li><li><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html">Mathlib.Probability.ProbabilityMassFunction.Basic</a></li><li><a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html">Mathlib.Probability.ProbabilityMassFunction.Constructions</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-HopfieldNet.Stochastic" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#State.ext"><span class="name">State</span>.<span class="name">ext</span></a></div><div class="nav_link"><a class="break_within" href="#State.ext_iff"><span class="name">State</span>.<span class="name">ext_iff</span></a></div><div class="nav_link"><a class="break_within" href="#decidableEqState"><span class="name">decidableEqState</span></a></div><div class="nav_link"><a class="break_within" href="#energy_decomposition"><span class="name">energy_decomposition</span></a></div><div class="nav_link"><a class="break_within" href="#weight_symmetry"><span class="name">weight_symmetry</span></a></div><div class="nav_link"><a class="break_within" href="#energy_sum_split"><span class="name">energy_sum_split</span></a></div><div class="nav_link"><a class="break_within" href="#NeuralNetwork.StatePMF"><span class="name">NeuralNetwork</span>.<span class="name">StatePMF</span></a></div><div class="nav_link"><a class="break_within" href="#NeuralNetwork.StochasticDynamics"><span class="name">NeuralNetwork</span>.<span class="name">StochasticDynamics</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.metropolisDecision"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisDecision</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.gibbsUpdateNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsUpdateNeuron</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.updateNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">updateNeuron</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.gibbsUpdateSingleNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsUpdateSingleNeuron</span></a></div><div class="nav_link"><a class="break_within" href="#ENNReal.«termℝ≥0∞_1»"><span class="name">ENNReal</span>.<span class="name">«termℝ≥0∞_1»</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.gibbsSamplingStep"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsSamplingStep</span></a></div><div class="nav_link"><a class="break_within" href="#instCoeReal_hopfieldNet"><span class="name">instCoeReal_hopfieldNet</span></a></div><div class="nav_link"><a class="break_within" href="#Array.mkArray_size"><span class="name">Array</span>.<span class="name">mkArray_size</span></a></div><div class="nav_link"><a class="break_within" href="#Array.mkArray_get"><span class="name">Array</span>.<span class="name">mkArray_get</span></a></div><div class="nav_link"><a class="break_within" href="#Array.mkArray_creates_valid_hopfield_params"><span class="name">Array</span>.<span class="name">mkArray_creates_valid_hopfield_params</span></a></div><div class="nav_link"><a class="break_within" href="#HopfieldNetwork.all_nodes_adjacent"><span class="name">HopfieldNetwork</span>.<span class="name">all_nodes_adjacent</span></a></div><div class="nav_link"><a class="break_within" href="#patternStochasticUpdate"><span class="name">patternStochasticUpdate</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.gibbsSamplingSteps"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsSamplingSteps</span></a></div><div class="nav_link"><a class="break_within" href="#temperatureSchedule"><span class="name">temperatureSchedule</span></a></div><div class="nav_link"><a class="break_within" href="#applyAnnealingSteps"><span class="name">applyAnnealingSteps</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.simulatedAnnealing"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">simulatedAnnealing</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.acceptanceProbability"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">acceptanceProbability</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.partitionFunction"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">partitionFunction</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.metropolisHastingsStep"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisHastingsStep</span></a></div><div class="nav_link"><a class="break_within" href="#NN.State.metropolisHastingsSteps"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisHastingsSteps</span></a></div><div class="nav_link"><a class="break_within" href="#boltzmannDistribution"><span class="name">boltzmannDistribution</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsTransitionProb"><span class="name">gibbsTransitionProb</span></a></div><div class="nav_link"><a class="break_within" href="#metropolisTransitionProb"><span class="name">metropolisTransitionProb</span></a></div><div class="nav_link"><a class="break_within" href="#total_variation_distance"><span class="name">total_variation_distance</span></a></div><div class="nav_link"><a class="break_within" href="#single_site_difference"><span class="name">single_site_difference</span></a></div><div class="nav_link"><a class="break_within" href="#state_equality_from_sites"><span class="name">state_equality_from_sites</span></a></div><div class="nav_link"><a class="break_within" href="#updateNeuron_preserves"><span class="name">updateNeuron_preserves</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_probs_sum_one"><span class="name">gibbs_probs_sum_one</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_bool_to_state_map"><span class="name">gibbs_bool_to_state_map</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_total_positive"><span class="name">gibbs_total_positive</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_total_not_top"><span class="name">gibbs_total_not_top</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_map_pos_implies_preimage"><span class="name">pmf_map_pos_implies_preimage</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_exists_bool"><span class="name">gibbsUpdate_exists_bool</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_possible_states"><span class="name">gibbsUpdate_possible_states</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_preserves_other_neurons"><span class="name">gibbsUpdate_preserves_other_neurons</span></a></div><div class="nav_link"><a class="break_within" href="#single_site_difference_unique"><span class="name">single_site_difference_unique</span></a></div><div class="nav_link"><a class="break_within" href="#single_site_is_update"><span class="name">single_site_is_update</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_binary_norm_sum_one"><span class="name">pmf_binary_norm_sum_one</span></a></div><div class="nav_link"><a class="break_within" href="#update_neuron_equiv"><span class="name">update_neuron_equiv</span></a></div><div class="nav_link"><a class="break_within" href="#different_activation_different_state"><span class="name">different_activation_different_state</span></a></div><div class="nav_link"><a class="break_within" href="#update_neuron_eq_iff"><span class="name">update_neuron_eq_iff</span></a></div><div class="nav_link"><a class="break_within" href="#bool_update_eq_iff"><span class="name">bool_update_eq_iff</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_filter_update_neuron"><span class="name">pmf_filter_update_neuron</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_normalization_factor"><span class="name">gibbs_normalization_factor</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_true"><span class="name">gibbs_prob_true</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_false"><span class="name">gibbs_prob_false</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_map_binary_state"><span class="name">pmf_map_binary_state</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_map_update_one"><span class="name">pmf_map_update_one</span></a></div><div class="nav_link"><a class="break_within" href="#pmf_map_update_neg_one"><span class="name">pmf_map_update_neg_one</span></a></div><div class="nav_link"><a class="break_within" href="#exp_ratio_to_sigmoid"><span class="name">exp_ratio_to_sigmoid</span></a></div><div class="nav_link"><a class="break_within" href="#local_field_eq_weighted_sum"><span class="name">local_field_eq_weighted_sum</span></a></div><div class="nav_link"><a class="break_within" href="#ENNReal_exp_ratio_to_sigmoid"><span class="name">ENNReal_exp_ratio_to_sigmoid</span></a></div><div class="nav_link"><a class="break_within" href="#ENNReal.div_ne_top"><span class="name">ENNReal</span>.<span class="name">div_ne_top</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_positive"><span class="name">gibbs_prob_positive</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_negative"><span class="name">gibbs_prob_negative</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_bool_to_state_map_positive"><span class="name">gibbs_bool_to_state_map_positive</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_bool_to_state_map_negative"><span class="name">gibbs_bool_to_state_map_negative</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_positive_case"><span class="name">gibbs_prob_positive_case</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_prob_negative_case"><span class="name">gibbs_prob_negative_case</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_pmf_structure"><span class="name">gibbsUpdate_pmf_structure</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_prob_positive"><span class="name">gibbsUpdate_prob_positive</span></a></div><div class="nav_link"><a class="break_within" href="#gibbsUpdate_prob_negative"><span class="name">gibbsUpdate_prob_negative</span></a></div><div class="nav_link"><a class="break_within" href="#hopfield_value_dichotomy"><span class="name">hopfield_value_dichotomy</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_update_single_neuron_prob"><span class="name">gibbs_update_single_neuron_prob</span></a></div><div class="nav_link"><a class="break_within" href="#single_site_transition_as_update"><span class="name">single_site_transition_as_update</span></a></div><div class="nav_link"><a class="break_within" href="#uniform_neuron_selection_prob"><span class="name">uniform_neuron_selection_prob</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_update_zero_other_sites"><span class="name">gibbs_update_zero_other_sites</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_transition_sum_simplification"><span class="name">gibbs_transition_sum_simplification</span></a></div><div class="nav_link"><a class="break_within" href="#single_site_difference_as_update"><span class="name">single_site_difference_as_update</span></a></div><div class="nav_link"><a class="break_within" href="#gibbs_update_preserves_other_sites"><span class="name">gibbs_update_preserves_other_sites</span></a></div><div class="nav_link"><a class="break_within" href="#uniform_neuron_prob"><span class="name">uniform_neuron_prob</span></a></div><div class="nav_link"><a class="break_within" href="#uniform_neuron_selection_prob_valid"><span class="name">uniform_neuron_selection_prob_valid</span></a></div></nav><main>
<div class="decl" id="State.ext"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L43-L52">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#State.ext"><span class="name">State</span>.<span class="name">ext</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Zero">Zero</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">NN</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s₁ </span><span class="fn">s₂</span> : <span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(∀ (<span class="fn">u</span> : <span class="fn">U</span>), <span class="fn"><span class="fn"><span class="fn">s₁</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s₂</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span>)</span> → <span class="fn">s₁</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">s₂</span></span></div></div><p>Extensionality lemma for neural network states -</p></div></div><div class="decl" id="State.ext_iff"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L44-L44">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#State.ext_iff"><span class="name">State</span>.<span class="name">ext_iff</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Zero">Zero</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">NN</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">s₁ </span><span class="fn">s₂</span> : <span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">s₁</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">s₂</span> <a href=".././Init/Core.html#Iff">↔</a> <span class="fn">∀ (<span class="fn">u</span> : <span class="fn">U</span>), <span class="fn"><span class="fn"><span class="fn">s₁</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s₂</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span></span></div></div></div></div><div class="decl" id="decidableEqState"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L54-L58">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#decidableEqState"><span class="name">decidableEqState</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#decidableEqState">decidableEqState</a> <span class="fn">s₁</span> <span class="fn">s₂</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Init/PropLemmas.html#decidable_of_iff">decidable_of_iff</a> <span class="fn">(∀ (<span class="fn">u</span> : <span class="fn">U</span>), <span class="fn"><span class="fn"><span class="fn">s₁</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s₂</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span>)</span> <span class="fn">⋯</span></span></li></ul></details></div></div><div class="decl" id="energy_decomposition"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L60-L66">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#energy_decomposition"><span class="name">energy_decomposition</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.E">NeuralNetwork.State.E</a> <span class="fn">wθ</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.Ew">NeuralNetwork.State.Ew</a> <span class="fn">wθ</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.Eθ">NeuralNetwork.State.Eθ</a> <span class="fn">wθ</span></span></div></div><p>Decompose energy into weight component and bias component -</p></div></div><div class="decl" id="weight_symmetry"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L68-L72">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#weight_symmetry"><span class="name">weight_symmetry</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v1 </span><span class="fn">v2</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">v1</span> <span class="fn">v2</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">v2</span> <span class="fn">v1</span></span></div></div><p>Weight matrix is symmetric in a Hopfield network -</p></div></div><div class="decl" id="energy_sum_split"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L74-L82">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#energy_sum_split"><span class="name">energy_sum_split</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">∑ <span class="fn">v</span> : <span class="fn">U</span>, <span class="fn">∑ <span class="fn">v2</span> : <span class="fn">U </span>with <span class="fn">v2</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">v</span>, <span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">v</span> <span class="fn">v2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v2</span></span></span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">∑ <span class="fn">v2</span> : <span class="fn">U </span>with <span class="fn">v2</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span>, <span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">u</span> <span class="fn">v2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v2</span></span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a>     <span class="fn">∑ <span class="fn">v</span> ∈ <span class="fn"><span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Finset.univ">Finset.univ</a>.<a href=".././Mathlib/Data/Finset/Erase.html#Finset.erase">erase</a></span> <span class="fn">u</span></span>, <span class="fn">∑ <span class="fn">v2</span> : <span class="fn">U </span>with <span class="fn">v2</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">v</span>, <span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">v</span> <span class="fn">v2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v2</span></span></span></span></div></div><p>Energy sum can be split into terms with u and terms without u -</p></div></div><div class="decl" id="NeuralNetwork.StatePMF"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L84-L85">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NeuralNetwork.StatePMF"><span class="name">NeuralNetwork</span>.<span class="name">StatePMF</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Zero">Zero</a> <span class="fn">R</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">NN</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Probability Mass Function over Neural Network States -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/Stochastic.html#NeuralNetwork.StatePMF">StatePMF</a></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></li></ul></details><details id="instances-for-list-NeuralNetwork.StatePMF" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NeuralNetwork.StochasticDynamics"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L87-L89">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NeuralNetwork.StochasticDynamics"><span class="name">NeuralNetwork</span>.<span class="name">StochasticDynamics</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Zero">Zero</a> <span class="fn">R</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">NN</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././foundational_types.html">Type</a></div></div><p>Temperature-parameterized stochastic dynamics for neural networks -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/Stochastic.html#NeuralNetwork.StochasticDynamics">StochasticDynamics</a></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">(<a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> → <span class="fn"><span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> → <span class="fn"><span class="fn">NN</span>.<a href=".././HopfieldNet/Stochastic.html#NeuralNetwork.StatePMF">StatePMF</a></span></span>)</span></li></ul></details><details id="instances-for-list-NeuralNetwork.StochasticDynamics" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.metropolisDecision"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L91-L95">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.metropolisDecision"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisDecision</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <a href=".././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Metropolis acceptance decision as a probability mass function over Boolean outcomes -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisDecision">NN.State.metropolisDecision</a> <span class="fn">p</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.bernoulli">PMF.bernoulli</a> <span class="fn">(<a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Init/Prelude.html#Min.min">min</a> <span class="fn">p</span> <span class="fn">1</span>)</span>)</span> <span class="fn">⋯</span></span></li></ul></details><details id="instances-for-list-NN.State.metropolisDecision" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.gibbsUpdateNeuron"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L97-L125">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsUpdateNeuron</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Performs a Gibbs update on a single neuron <code>u</code> of the state <code>s</code>.
The update probability depends on the energy change associated with flipping the neuron's state,
parameterized by the temperature <code>T</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-NN.State.gibbsUpdateNeuron" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.updateNeuron"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L127-L137">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">updateNeuron</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></div></div><p>Function to set a specific neuron state -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././HopfieldNet/NN.html#NeuralNetwork.State.mk">{</a> <span class="fn">act</span> := <span class="fn">fun (<span class="fn">u'</span> : <span class="fn">U</span>) =&gt; <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">u'</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">u</span> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">val</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u'</span></span></span>, <span class="fn">hp</span> := <span class="fn">⋯</span> <a href=".././HopfieldNet/NN.html#NeuralNetwork.State.mk">}</a></li></ul></details><details id="instances-for-list-NN.State.updateNeuron" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.gibbsUpdateSingleNeuron"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L139-L174">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsUpdateSingleNeuron</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Update a single neuron according to Gibbs sampling rule -</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-NN.State.gibbsUpdateSingleNeuron" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="ENNReal.«termℝ≥0∞_1»"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L176-L177">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#ENNReal.«termℝ≥0∞_1»"><span class="name">ENNReal</span>.<span class="name">«termℝ≥0∞_1»</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href=".././Init/Prelude.html#Lean.ParserDescr">Lean.ParserDescr</a></div></div><p>The extended nonnegative real numbers. This is usually denoted [0, ∞],
and is relevant as the codomain of a measure.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href=".././HopfieldNet/Stochastic.html#ENNReal.«termℝ≥0∞_1»">ENNReal.«termℝ≥0∞_1»</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Init/Prelude.html#Lean.ParserDescr.node">Lean.ParserDescr.node</a> <span class="fn">`ENNReal.«termℝ≥0∞_1»</span> <span class="fn">1024</span> <span class="fn">(<a href=".././Init/Prelude.html#Lean.ParserDescr.symbol">Lean.ParserDescr.symbol</a> <span class="fn">&quot;ℝ≥0∞&quot;</span>)</span></span></li></ul></details><details id="instances-for-list-ENNReal.«termℝ≥0∞_1»" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.gibbsSamplingStep"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L179-L202">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingStep"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsSamplingStep</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Given a Hopfield Network's parameters, temperature, and current state, performs a single step
of Gibbs sampling by:</p><ol>
<li>Uniformly selecting a random neuron</li>
<li>Updating that neuron's state according to the Gibbs distribution</li>
</ol><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingStep">NN.State.gibbsSamplingStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">U</span>) =&gt; <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span>)</span> <span class="fn">⋯</span>)</span>.<a href=".././Mathlib/Probability/ProbabilityMassFunction/Monad.html#PMF.bind">bind</a></span> <span class="fn">fun (<span class="fn">u</span> : <span class="fn">U</span>) =&gt; <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">u</span></span></span></span></li></ul></details><details id="instances-for-list-NN.State.gibbsSamplingStep" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="instCoeReal_hopfieldNet"><div class="instance"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L204-L204">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#instCoeReal_hopfieldNet"><span class="name">instCoeReal_hopfieldNet</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><a href=".././HopfieldNet/Stochastic.html#instCoeReal_hopfieldNet">instCoeReal_hopfieldNet</a> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Coe.html#Coe.mk">{</a> <span class="fn">coe</span> := <a href=".././Init/Prelude.html#id">id</a> <a href=".././Init/Coe.html#Coe.mk">}</a></li></ul></details></div></div><div class="decl" id="Array.mkArray_size"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L205-L206">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#Array.mkArray_size"><span class="name">Array</span>.<span class="name">mkArray_size</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(<a href=".././Init/Data/Array/Basic.html#Array.replicate">replicate</a> <span class="fn">n</span> <span class="fn">a</span>)</span>.<a href=".././Init/Prelude.html#Array.size">size</a></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">n</span></div></div></div></div><div class="decl" id="Array.mkArray_get"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L208-L210">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#Array.mkArray_get"><span class="name">Array</span>.<span class="name">mkArray_get</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">a</span> : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">i</span> <a href=".././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn">n</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">(<a href=".././Init/Data/Array/Basic.html#Array.replicate">replicate</a> <span class="fn">n</span> <span class="fn">a</span>)</span><a href=".././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">i</span><a href=".././Init/GetElem.html#GetElem.getElem">]</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">a</span></div></div></div></div><div class="decl" id="Array.mkArray_creates_valid_hopfield_params"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L212-L235">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#Array.mkArray_creates_valid_hopfield_params"><span class="name">Array</span>.<span class="name">mkArray_creates_valid_hopfield_params</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">σ_u</span> := <span class="fn"><a href=".././Init/Data/Array/Basic.html#Array.replicate">replicate</a> <span class="fn">(<span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.κ1">κ1</a></span> <span class="fn">u</span>)</span> <span class="fn">0</span></span>;
<span class="fn">let <span class="fn">θ_u</span> := <span class="fn"><a href=".././Init/Data/Array/Basic.html#Array.replicate">replicate</a> <span class="fn">(<span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.κ2">κ2</a></span> <span class="fn">u</span>)</span> <span class="fn">0</span></span>;
<span class="fn"><span class="fn">σ_u</span>.<a href=".././Init/Prelude.html#Array.size">size</a></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.κ1">κ1</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#And">∧</a>   <span class="fn"><span class="fn">θ_u</span>.<a href=".././Init/Prelude.html#Array.size">size</a></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.κ2">κ2</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#And">∧</a>     <span class="fn">(∀ (<span class="fn">i</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>) (<span class="fn">h</span> : <span class="fn">i</span> <a href=".././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn"><span class="fn">σ_u</span>.<a href=".././Init/Prelude.html#Array.size">size</a></span>), <span class="fn">σ_u</span><a href=".././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">i</span><a href=".././Init/GetElem.html#GetElem.getElem">]</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">0</span>)</span> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn">∀ (<span class="fn">i</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>) (<span class="fn">h</span> : <span class="fn">i</span> <a href=".././Init/Prelude.html#LT.lt">&lt;</a> <span class="fn"><span class="fn">θ_u</span>.<a href=".././Init/Prelude.html#Array.size">size</a></span>), <span class="fn">θ_u</span><a href=".././Init/GetElem.html#GetElem.getElem">[</a><span class="fn">i</span><a href=".././Init/GetElem.html#GetElem.getElem">]</a> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">0</span></span></span></span></div></div><p>Proves that <code><a href=".././Init/Data/Array/Basic.html#Array.mkArray">Array.mkArray</a></code> creates valid parameters for a Hopfield network.
Given a vertex <code>u</code> in a Hopfield network with <code>n</code> nodes, this lemma establishes that:</p><ol>
<li>The array <code>σ_u</code> has size equal to <code>κ1 u</code></li>
<li>The array <code>θ_u</code> has size equal to <code>κ2 u</code></li>
<li>All elements in <code>σ_u</code> are initialized to 0</li>
<li>All elements in <code>θ_u</code> are initialized to 0
where <code>κ1</code> and <code>κ2</code> are dimension functions defined in the <code><a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a></code> structure.</li>
</ol></div></div><div class="decl" id="HopfieldNetwork.all_nodes_adjacent"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L237-L247">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#HopfieldNetwork.all_nodes_adjacent"><span class="name">HopfieldNetwork</span>.<span class="name">all_nodes_adjacent</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">u </span><span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Not">¬</a><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././Mathlib/Combinatorics/Digraph/Basic.html#Digraph.Adj">Adj</a></span> <span class="fn">u</span> <span class="fn">v</span></span> → <span class="fn">u</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">v</span></span></div></div><h2 class="markdown-heading" id="In-a-Hopfield-network-two-neurons-are-adjacent-if-and-only-if-they-are-different-This-formalizes-the-fully-connected-nature-of-Hopfield-networks">In a Hopfield network, two neurons are adjacent if and only if they are different.
This formalizes the fully connected nature of Hopfield networks. <a class="hover-link" href="#In-a-Hopfield-network-two-neurons-are-adjacent-if-and-only-if-they-are-different-This-formalizes-the-fully-connected-nature-of-Hopfield-networks">#</a></h2></div></div><div class="decl" id="patternStochasticUpdate"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L249-L272">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#patternStochasticUpdate"><span class="name">patternStochasticUpdate</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">n</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">weights</span> : <span class="fn"><span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span> → <span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span> → <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_diag_zero</span> : <span class="fn">∀ (<span class="fn">i</span> : <span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span>), <span class="fn"><span class="fn">weights</span> <span class="fn">i</span> <span class="fn">i</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">0</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_sym</span> : <span class="fn">∀ (<span class="fn">i </span><span class="fn">j</span> : <span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span>), <span class="fn"><span class="fn">weights</span> <span class="fn">i</span> <span class="fn">j</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">weights</span> <span class="fn">j</span> <span class="fn">i</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">pattern</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">i</span> : <span class="fn"><a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a> <span class="fn">(<a href=".././Init/Prelude.html#Fin">Fin</a> <span class="fn">n</span>)</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Perform a stochastic update on a Pattern representation</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-patternStochasticUpdate" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.gibbsSamplingSteps"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L274-L286">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingSteps"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">gibbsSamplingSteps</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">steps</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Performs multiple steps of Gibbs sampling in a Hopfield network, starting from
an initial state. Each step involves:</p><ol>
<li>First recursively applying previous steps (if any)</li>
<li>Then performing a single Gibbs sampling step on the resulting state
The temperature parameter T controls the randomness of the updates. -</li>
</ol><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingSteps">NN.State.gibbsSamplingSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">0</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Monad.html#PMF.pure">PMF.pure</a> <span class="fn">s</span></span></li><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingSteps">NN.State.gibbsSamplingSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn"><span class="fn">steps_2</span>.<a href=".././Init/Prelude.html#Nat.succ">succ</a></span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingSteps">NN.State.gibbsSamplingSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">steps_2</span> <span class="fn">s</span>)</span>.<a href=".././Mathlib/Probability/ProbabilityMassFunction/Monad.html#PMF.bind">bind</a></span> <span class="fn">fun (<span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) =&gt;
    <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingStep">NN.State.gibbsSamplingStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s'</span></span></span></span></li></ul></details><details id="instances-for-list-NN.State.gibbsSamplingSteps" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="temperatureSchedule"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L288-L290">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#temperatureSchedule"><span class="name">temperatureSchedule</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">initial_temp </span><span class="fn">cooling_rate</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">step</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>Temperature schedule for simulated annealing that decreases exponentially with each step.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#temperatureSchedule">temperatureSchedule</a> <span class="fn">initial_temp</span> <span class="fn">cooling_rate</span> <span class="fn">step</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">initial_temp</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">cooling_rate</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">↑<span class="fn">step</span></span>)</span></li></ul></details><details id="instances-for-list-temperatureSchedule" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="applyAnnealingSteps"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L292-L311">source</a></div><div class="attributes">@[irreducible]</div>
<div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#applyAnnealingSteps"><span class="name">applyAnnealingSteps</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">temp_schedule</span> : <span class="fn"><a href=".././Init/Prelude.html#Nat">ℕ</a> → <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">steps </span><span class="fn">step</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">state</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Recursively applies Gibbs sampling steps with decreasing temperature according to
the cooling schedule, terminating when the step count reaches the target number of steps.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-applyAnnealingSteps" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.simulatedAnnealing"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L313-L324">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.simulatedAnnealing"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">simulatedAnnealing</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">initial_temp </span><span class="fn">cooling_rate</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">steps</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">initial_state</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p><code><a href=".././HopfieldNet/Stochastic.html#NN.State.simulatedAnnealing">NN.State.simulatedAnnealing</a></code> implements the simulated annealing optimization algorithm for a Hopfield Network.
This function performs simulated annealing by starting from an initial state and gradually reducing
the temperature according to an exponential cooling schedule, allowing the system to explore the
state space and eventually settle into a low-energy configuration.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.simulatedAnnealing">NN.State.simulatedAnnealing</a> <span class="fn">wθ</span> <span class="fn">initial_temp</span> <span class="fn">cooling_rate</span> <span class="fn">steps</span> <span class="fn">initial_state</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././HopfieldNet/Stochastic.html#applyAnnealingSteps">applyAnnealingSteps</a> <span class="fn">wθ</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#temperatureSchedule">temperatureSchedule</a> <span class="fn">initial_temp</span> <span class="fn">cooling_rate</span>)</span> <span class="fn">steps</span> <span class="fn">0</span> <span class="fn">initial_state</span></span></li></ul></details><details id="instances-for-list-NN.State.simulatedAnnealing" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.acceptanceProbability"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L326-L340">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.acceptanceProbability"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">acceptanceProbability</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">current </span><span class="fn">proposed</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>Given a HopfieldNetwork with parameters <code>wθ</code> and temperature <code>T</code>, computes the acceptance probability
for transitioning from a <code>current</code> state to a <code>proposed</code> state according to the Metropolis-Hastings algorithm.</p><ul>
<li>If the energy difference (ΔE) is negative or zero, returns 1.0 (always accepts the transition)</li>
<li>If the energy difference is positive, returns exp(-ΔE/T) following the Boltzmann distribution</li>
</ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-NN.State.acceptanceProbability" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.partitionFunction"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L342-L348">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.partitionFunction"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">partitionFunction</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>The partition function for a Hopfield network, defined as the sum over all possible states
of the Boltzmann factor <code>exp(-E/T)</code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.partitionFunction">NN.State.partitionFunction</a> <span class="fn">wθ</span> <span class="fn">T</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn">∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.E">NeuralNetwork.State.E</a> <span class="fn">wθ</span> <span class="fn">s</span>)</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>)</span></span></li></ul></details><details id="instances-for-list-NN.State.partitionFunction" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.metropolisHastingsStep"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L350-L380">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsStep"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisHastingsStep</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Metropolis-Hastings single step for Hopfield networks -</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-NN.State.metropolisHastingsStep" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="NN.State.metropolisHastingsSteps"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L382-L390">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsSteps"><span class="name">NN</span>.<span class="name">State</span>.<span class="name">metropolisHastingsSteps</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">steps</span> : <a href=".././Init/Prelude.html#Nat">ℕ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>Multiple steps of Metropolis-Hastings algorithm for Hopfield networks -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsSteps">NN.State.metropolisHastingsSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">0</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Monad.html#PMF.pure">PMF.pure</a> <span class="fn">s</span></span></li><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsSteps">NN.State.metropolisHastingsSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn"><span class="fn">steps_2</span>.<a href=".././Init/Prelude.html#Nat.succ">succ</a></span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsSteps">NN.State.metropolisHastingsSteps</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">steps_2</span> <span class="fn">s</span>)</span>.<a href=".././Mathlib/Probability/ProbabilityMassFunction/Monad.html#PMF.bind">bind</a></span> <span class="fn">fun (<span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>) =&gt;
    <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsStep">NN.State.metropolisHastingsStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s'</span></span></span></span></li></ul></details><details id="instances-for-list-NN.State.metropolisHastingsSteps" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="boltzmannDistribution"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L392-L396">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#boltzmannDistribution"><span class="name">boltzmannDistribution</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> → <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span></div></div><p>The Boltzmann (Gibbs) distribution over neural network states -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#boltzmannDistribution">boltzmannDistribution</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#NeuralNetwork.State.E">NeuralNetwork.State.E</a> <span class="fn">wθ</span> <span class="fn">s</span>)</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>)</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.partitionFunction">NN.State.partitionFunction</a> <span class="fn">wθ</span> <span class="fn">T</span></span></li></ul></details><details id="instances-for-list-boltzmannDistribution" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="gibbsTransitionProb"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L398-L402">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsTransitionProb"><span class="name">gibbsTransitionProb</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>The transition probability matrix for Gibbs sampling -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#gibbsTransitionProb">gibbsTransitionProb</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span> <span class="fn">s'</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsSamplingStep">NN.State.gibbsSamplingStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span>)</span> <span class="fn">s'</span>)</span>.<a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.toReal">toReal</a></span></li></ul></details><details id="instances-for-list-gibbsTransitionProb" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="metropolisTransitionProb"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L404-L408">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#metropolisTransitionProb"><span class="name">metropolisTransitionProb</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>The transition probability matrix for Metropolis-Hastings -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#metropolisTransitionProb">metropolisTransitionProb</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span> <span class="fn">s'</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.metropolisHastingsStep">NN.State.metropolisHastingsStep</a> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">s</span>)</span> <span class="fn">s'</span>)</span>.<a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.toReal">toReal</a></span></li></ul></details><details id="instances-for-list-metropolisTransitionProb" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="total_variation_distance"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L410-L414">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#total_variation_distance"><span class="name">total_variation_distance</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">μ </span><span class="fn">ν</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span> → <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>Total variation distance between probability distributions -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#total_variation_distance">total_variation_distance</a> <span class="fn">μ</span> <span class="fn">ν</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">1</span> / <span class="fn">2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">∑ <span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>, <a href=".././Mathlib/Algebra/Order/Group/Unbundled/Abs.html#abs">|</a><span class="fn"><span class="fn">μ</span> <span class="fn">s</span></span> <a href=".././Init/Prelude.html#HSub.hSub">-</a> <span class="fn"><span class="fn">ν</span> <span class="fn">s</span></span><a href=".././Mathlib/Algebra/Order/Group/Unbundled/Abs.html#abs">|</a></span></li></ul></details><details id="instances-for-list-total_variation_distance" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="single_site_difference"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L416-L443">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#single_site_difference"><span class="name">single_site_difference</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">s</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">s'</span> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn">∃ (<span class="fn">u</span> : <span class="fn">U</span>), <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">∃!</a> <span class="fn">u</span> <a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">:</a> <span class="fn">U</span><a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">,</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span></div></div><p>When states differ at exactly one site, we can identify that site -</p></div></div><div class="decl" id="state_equality_from_sites"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L445-L451">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#state_equality_from_sites"><span class="name">state_equality_from_sites</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">u</span> : <span class="fn">U</span>), <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">s</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">s'</span></div></div><p>States that are equal at all sites are equal -</p></div></div><div class="decl" id="updateNeuron_preserves"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L453-L461">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#updateNeuron_preserves"><span class="name">updateNeuron_preserves</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v </span><span class="fn">w</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">w</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">v</span> → <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">val</span> <span class="fn">hval</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span></span></div></div><p>The updateNeuron function only changes the specified neuron, leaving others unchanged -</p></div></div><div class="decl" id="gibbs_probs_sum_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L463-L491">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_probs_sum_one"><span class="name">gibbs_probs_sum_one</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">v</span></span>;
<span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">probs</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span></span>;
<span class="fn">∑ <span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>, <span class="fn"><span class="fn">norm_probs</span> <span class="fn">b</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span></span></span></span></span></div></div><p>For Gibbs updates, given the normalization and probabilities, the sum of normalized probabilities equals 1 -</p></div></div><div class="decl" id="gibbs_bool_to_state_map"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L493-L500">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map"><span class="name">gibbs_bool_to_state_map</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Init/Prelude.html#Bool">Bool</a> → <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></span></div></div><p>The function that maps boolean values to states in Gibbs sampling -</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></li></ul></details><details id="instances-for-list-gibbs_bool_to_state_map" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="gibbs_total_positive"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L502-L520">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_total_positive"><span class="name">gibbs_total_positive</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span></span></div></div><p>The total normalization constant for Gibbs sampling is positive -</p></div></div><div class="decl" id="gibbs_total_not_top"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L522-L531">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_total_not_top"><span class="name">gibbs_total_not_top</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span> <a href=".././Init/Core.html#Ne">≠</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a></span></div></div><p>The total normalization constant for Gibbs sampling is not infinity -</p></div></div><div class="decl" id="pmf_map_pos_implies_preimage"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L533-L541">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_map_pos_implies_preimage"><span class="name">pmf_map_pos_implies_preimage</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">α </span><span class="fn">β</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">α</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">β</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">p</span> : <span class="fn"><span class="fn">α</span> → <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">h_pmf</span> : <span class="fn">∑ <span class="fn">a</span> : <span class="fn">α</span>, <span class="fn"><span class="fn">p</span> <span class="fn">a</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">f</span> : <span class="fn"><span class="fn">α</span> → <span class="fn">β</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">y</span> : <span class="fn">β</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">f</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">p</span> <span class="fn">h_pmf</span>)</span>)</span> <span class="fn">y</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> → <span class="fn">∃ (<span class="fn">x</span> : <span class="fn">α</span>), <span class="fn"><span class="fn">p</span> <span class="fn">x</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn"><span class="fn">f</span> <span class="fn">x</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">y</span></span></span></div></div><p>For a positive PMF.map application, there exists a preimage with positive probability -</p></div></div><div class="decl" id="gibbsUpdate_exists_bool"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L543-L573">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_exists_bool"><span class="name">gibbsUpdate_exists_bool</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s_next</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s_next</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> → <span class="fn">∃ (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>), <span class="fn">s_next</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">b</span></span></span></span></div></div><p>For states with positive Gibbs update probability, there exists a boolean variable that
determines whether the state has activation 1 or -1 at the updated neuron -</p></div></div><div class="decl" id="gibbsUpdate_possible_states"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L575-L598">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_possible_states"><span class="name">gibbsUpdate_possible_states</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s_next</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s_next</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> →
  <span class="fn">s_next</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#Or">∨</a> <span class="fn">s_next</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">v</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span></div></div><p>For states with positive probability under gibbsUpdateSingleNeuron,
they must be one of exactly two possible states (with neuron v set to 1 or -1) -</p></div></div><div class="decl" id="gibbsUpdate_preserves_other_neurons"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L600-L617">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_preserves_other_neurons"><span class="name">gibbsUpdate_preserves_other_neurons</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v </span><span class="fn">w</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_neq</span> : <span class="fn">w</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">v</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s_next</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s_next</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> → <span class="fn"><span class="fn"><span class="fn">s_next</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span></span></div></div><p>Gibbs update preserves states at non-updated sites -</p></div></div><div class="decl" id="single_site_difference_unique"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L619-L642">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#single_site_difference_unique"><span class="name">single_site_difference_unique</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_diff</span> : <span class="fn">s</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">s'</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">∃!</a> <span class="fn">v</span> <a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">:</a> <span class="fn">U</span><a href=".././Mathlib/Logic/ExistsUnique.html#ExistsUnique">,</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></div></div><p>For states differing at only one site, that site must be u -</p></div></div><div class="decl" id="single_site_is_update"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L644-L659">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#single_site_is_update"><span class="name">single_site_is_update</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">s'</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(<span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span>)</span> <span class="fn">⋯</span></span></div></div><p>Given a single-site difference, the destination state is
an update of the source state -</p></div></div><div class="decl" id="pmf_binary_norm_sum_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L661-L690">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_binary_norm_sum_one"><span class="name">pmf_binary_norm_sum_one</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">probs</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span></span>;
<span class="fn">∑ <span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>, <span class="fn"><span class="fn">norm_probs</span> <span class="fn">b</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span></span></span></span></div></div><p>The probability mass function for a binary choice (true/false)
has sum 1 when properly normalized -</p></div></div><div class="decl" id="update_neuron_equiv"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L692-L707">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#update_neuron_equiv"><span class="name">update_neuron_equiv</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> → <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span></span></div></div><p>When updating a neuron with a value that equals one of the
standard values (1 or -1), the result equals the standard update -</p></div></div><div class="decl" id="different_activation_different_state"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L709-L726">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#different_activation_different_state"><span class="name">different_activation_different_state</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></div></div><p>Updates with different activation values produce different states -</p></div></div><div class="decl" id="update_neuron_eq_iff"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L728-L748">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#update_neuron_eq_iff"><span class="name">update_neuron_eq_iff</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val₁ </span><span class="fn">val₂</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval₁</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val₁</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval₂</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val₂</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val₁</span> <span class="fn">hval₁</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val₂</span> <span class="fn">hval₂</span></span> <a href=".././Init/Core.html#Iff">↔</a> <span class="fn">val₁</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">val₂</span></div></div><p>Two neuron updates at the same site are equal if and only if
their new values are equal -</p></div></div><div class="decl" id="bool_update_eq_iff"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L750-L776">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#bool_update_eq_iff"><span class="name">bool_update_eq_iff</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type">(<a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span>) <a href=".././Init/Prelude.html#Eq">=</a>     <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span> <a href=".././Init/Core.html#Iff">↔</a>   <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#Or">∨</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.false">false</a> <a href=".././Init/Prelude.html#And">∧</a> <span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">-<span class="fn">1</span></span></div></div><p>Determines when a boolean-indexed update equals a specific update -</p></div></div><div class="decl" id="pmf_filter_update_neuron"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L778-L816">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_filter_update_neuron"><span class="name">pmf_filter_update_neuron</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">f</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span>;
<span class="fn">{<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a> | <span class="fn"><span class="fn">f</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span>}</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">then</a> <a href=".././Init/Core.html#Singleton.singleton">{</a><a href=".././Init/Prelude.html#Bool.true">true</a><a href=".././Init/Core.html#Singleton.singleton">}</a> <a href=".././Init/Prelude.html#ite">else</a> <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">-<span class="fn">1</span></span> <a href=".././Init/Prelude.html#ite">then</a> <a href=".././Init/Core.html#Singleton.singleton">{</a><a href=".././Init/Prelude.html#Bool.false">false</a><a href=".././Init/Core.html#Singleton.singleton">}</a> <a href=".././Init/Prelude.html#ite">else</a> <a href=".././Init/Core.html#EmptyCollection.emptyCollection">∅</a></span></div></div><p>When filtering a PMF with binary support to states matching a given state's update,
the result reduces to a singleton if the update site matches -</p></div></div><div class="decl" id="gibbs_normalization_factor"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L818-L830">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_normalization_factor"><span class="name">gibbs_normalization_factor</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">total</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span></div></div><p>The normalization factor in Gibbs sampling is the sum of Boltzmann
factors for both possible states -</p></div></div><div class="decl" id="gibbs_prob_true"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L832-L850">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_true"><span class="name">gibbs_prob_true</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">probs</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span></span>;
<span class="fn"><span class="fn">norm_probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a>     (<span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>)</span></span></span></div></div><p>The probability mass assigned to true when using Gibbs sampling -</p></div></div><div class="decl" id="gibbs_prob_false"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L852-L868">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_false"><span class="name">gibbs_prob_false</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">probs</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span></span>;
<span class="fn"><span class="fn">norm_probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a>     (<span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>)</span></span></span></div></div><p>The probability mass assigned to false when using Gibbs sampling -</p></div></div><div class="decl" id="pmf_map_binary_state"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L870-L942">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_map_binary_state"><span class="name">pmf_map_binary_state</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href=".././Init/Prelude.html#Bool">Bool</a> → <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_sum</span> : <span class="fn">∑ <span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>, <span class="fn"><span class="fn">p</span> <span class="fn">b</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">f</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span>;
<span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">f</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">p</span> <span class="fn">h_sum</span>)</span>)</span> <span class="fn">(<span class="fn">f</span> <span class="fn">b</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">p</span> <span class="fn">b</span></span></span></div></div><p>For a PMF over binary values mapped to states, the probability of a specific state
equals the probability of its corresponding binary value -</p></div></div><div class="decl" id="pmf_map_update_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L944-L953">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_map_update_one"><span class="name">pmf_map_update_one</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href=".././Init/Prelude.html#Bool">Bool</a> → <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_sum</span> : <span class="fn">∑ <span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>, <span class="fn"><span class="fn">p</span> <span class="fn">b</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">f</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span>;
<span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">f</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">p</span> <span class="fn">h_sum</span>)</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">p</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span></span></div></div><p>A specialized version of the previous lemma for the case where the state is an update with new_val = 1 -</p></div></div><div class="decl" id="pmf_map_update_neg_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L955-L964">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#pmf_map_update_neg_one"><span class="name">pmf_map_update_neg_one</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href=".././Init/Prelude.html#Bool">Bool</a> → <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_sum</span> : <span class="fn">∑ <span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>, <span class="fn"><span class="fn">p</span> <span class="fn">b</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">f</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span>;
<span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">f</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">p</span> <span class="fn">h_sum</span>)</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">p</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span></span></div></div><p>A specialized version for the case where the state is an update with new_val = -1 -</p></div></div><div class="decl" id="exp_ratio_to_sigmoid"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L966-L981">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#exp_ratio_to_sigmoid"><span class="name">exp_ratio_to_sigmoid</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">x</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">x</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">x</span>)</span>) <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">-<span class="fn">2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">x</span>)</span>)</div></div><h2 class="markdown-heading" id="Expresses-a-ratio-of-exponentials-in-terms-of-the-sigmoid-function-format">Expresses a ratio of exponentials in terms of the sigmoid function format. <a class="hover-link" href="#Expresses-a-ratio-of-exponentials-in-terms-of-the-sigmoid-function-format">#</a></h2></div></div><div class="decl" id="local_field_eq_weighted_sum"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L983-L999">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#local_field_eq_weighted_sum"><span class="name">local_field_eq_weighted_sum</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">∑ <span class="fn">v</span> ∈ <span class="fn"><span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Finset.univ">Finset.univ</a>.<a href=".././Mathlib/Data/Finset/Erase.html#Finset.erase">erase</a></span> <span class="fn">u</span></span>, <span class="fn"><span class="fn"><span class="fn">wθ</span>.<a href=".././HopfieldNet/NN.html#Params.w">w</a></span> <span class="fn">u</span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></div></div><p>Local field is the weighted sum of incoming activations -</p></div></div><div class="decl" id="ENNReal_exp_ratio_to_sigmoid"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1001-L1031">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#ENNReal_exp_ratio_to_sigmoid"><span class="name">ENNReal_exp_ratio_to_sigmoid</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">x</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">x</span>)</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> <span class="fn">x</span>)</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">x</span>))</span></span>) <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">-<span class="fn">2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">x</span>)</span>))</span></div></div><p>Converts the ratio of Boltzmann factors to ENNReal sigmoid form. -</p></div></div><div class="decl" id="ENNReal.div_ne_top"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1033-L1039">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#ENNReal.div_ne_top"><span class="name">ENNReal</span>.<span class="name">div_ne_top</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">a </span><span class="fn">b</span> : <a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal">ENNReal</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">ha</span> : <span class="fn">a</span> <a href=".././Init/Core.html#Ne">≠</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hb</span> : <span class="fn">b</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">a</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">b</span> <a href=".././Init/Core.html#Ne">≠</a> <a href=".././Mathlib/Order/Notation.html#Top.top">⊤</a></div></div></div></div><div class="decl" id="gibbs_prob_positive"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1041-L1069">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_positive"><span class="name">gibbs_prob_positive</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">-<span class="fn">2</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>)</span>))</span></span></span></div></div></div></div><div class="decl" id="gibbs_prob_negative"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1071-L1099">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_negative"><span class="name">gibbs_prob_negative</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">local_field </span><span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">local_field</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn">2</span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">local_field</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>)</span>))</span></span></span></div></div><p>The probability of setting a neuron to -1 under Gibbs sampling -</p></div></div><div class="decl" id="gibbs_bool_to_state_map_positive"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1101-L1115">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map_positive"><span class="name">gibbs_bool_to_state_map_positive</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> → <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span></span></span></div></div></div></div><div class="decl" id="gibbs_bool_to_state_map_negative"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1117-L1130">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map_negative"><span class="name">gibbs_bool_to_state_map_negative</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">-<span class="fn">1</span></span> → <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">val</span> <span class="fn">hval</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span></span></span></div></div></div></div><div class="decl" id="gibbs_prob_positive_case"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1133-L1169">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_positive_case"><span class="name">gibbs_prob_positive_case</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">Z</span> := <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span>
  <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span></span>;
<span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">norm_probs</span> <span class="fn">⋯</span>)</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">norm_probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span></span></span></span></div></div></div></div><div class="decl" id="gibbs_prob_negative_case"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1172-L1206">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_prob_negative_case"><span class="name">gibbs_prob_negative_case</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">Z</span> := <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span>
  <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span></span>;
<span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">norm_probs</span> <span class="fn">⋯</span>)</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn">norm_probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span></span></span></span></div></div></div></div><div class="decl" id="gibbsUpdate_pmf_structure"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1208-L1257">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_pmf_structure"><span class="name">gibbsUpdate_pmf_structure</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt;
  <span class="fn">let <span class="fn">new_act_val</span> := <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">b</span> <a href=".././Init/Prelude.html#Eq">=</a> <a href=".././Init/Prelude.html#Bool.true">true</a> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">else</a> <span class="fn">-<span class="fn">1</span></span>;
  <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">new_act_val</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span></span></span>;
<span class="fn">let <span class="fn">total</span> := <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.true">true</a></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn">probs</span> <a href=".././Init/Prelude.html#Bool.false">false</a></span>;
<span class="fn">let <span class="fn">norm_probs</span> := <span class="fn">fun (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>) =&gt; <span class="fn"><span class="fn">probs</span> <span class="fn">b</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">total</span></span>;
<span class="fn">∀ (<span class="fn">b</span> : <a href=".././Init/Prelude.html#Bool">Bool</a>),
  <span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.map">PMF.map</a> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">norm_probs</span> <span class="fn">⋯</span>)</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#gibbs_bool_to_state_map">gibbs_bool_to_state_map</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">b</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">norm_probs</span> <span class="fn">b</span></span></span></span></span></span></span></div></div><p>PMF map from boolean values to updated states preserves probability structure -</p></div></div><div class="decl" id="gibbsUpdate_prob_positive"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1259-L1293">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_prob_positive"><span class="name">gibbsUpdate_prob_positive</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">Z</span> := <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>;
<span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">1</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span></span></span></div></div><p>The probability of updating a neuron to 1 using Gibbs sampling -</p></div></div><div class="decl" id="gibbsUpdate_prob_negative"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1295-L1331">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbsUpdate_prob_negative"><span class="name">gibbsUpdate_prob_negative</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">Z</span> := <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>;
<span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(-<span class="fn">1</span>)</span> <span class="fn">⋯</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span></span></span></div></div><p>The probability of updating a neuron to -1 using Gibbs sampling -</p></div></div><div class="decl" id="hopfield_value_dichotomy"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1333-L1345">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#hopfield_value_dichotomy"><span class="name">hopfield_value_dichotomy</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">val</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">1</span> → <span class="fn">val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">-<span class="fn">1</span></span></span></div></div><p>In a Hopfield network, activation values can only be 1 or -1. -</p></div></div><div class="decl" id="gibbs_update_single_neuron_prob"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1347-L1374">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_update_single_neuron_prob"><span class="name">gibbs_update_single_neuron_prob</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">new_val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hval</span> : <span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.pact">pact</a></span> <span class="fn">new_val</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">local_field</span> := <span class="fn"><a href=".././HopfieldNet/NN.html#NeuralNetwork.State.net">NeuralNetwork.State.net</a> <span class="fn">wθ</span> <span class="fn">s</span> <span class="fn">u</span></span>;
<span class="fn">let <span class="fn">Z</span> := <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span>;
<span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">u</span>)</span> <span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">new_val</span> <span class="fn">hval</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a>   <a href=".././Init/Prelude.html#ite">if</a> <span class="fn">new_val</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#ite">then</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span>
  <a href=".././Init/Prelude.html#ite">else</a> <span class="fn"><a href=".././Mathlib/Data/ENNReal/Basic.html#ENNReal.ofReal">ENNReal.ofReal</a> <span class="fn">(<a href=".././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href=".././Init/Prelude.html#Neg.neg">-</a><span class="fn"><a href=".././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">local_field</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">T</span>))</span></span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">Z</span></span></span></div></div><p>Computes the probability of updating a neuron to a specific value using Gibbs sampling.</p><ul>
<li>If new_val = 1: probability = exp(local_field/T)/Z</li>
<li>If new_val = -1: probability = exp(-local_field/T)/Z
where Z is the normalization constant (partition function).</li>
<li></li>
</ul></div></div><div class="decl" id="single_site_transition_as_update"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1376-L1391">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#single_site_transition_as_update"><span class="name">single_site_transition_as_update</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">s'</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(<span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span>)</span> <span class="fn">⋯</span></span></div></div><p>When states differ at exactly one site, the later state can be expressed as
an update of the first state at that site -</p></div></div><div class="decl" id="uniform_neuron_selection_prob"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1393-L1408">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#uniform_neuron_selection_prob"><span class="name">uniform_neuron_selection_prob</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">p</span> := <span class="fn">fun (<span class="fn">x</span> : <span class="fn">U</span>) =&gt; <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span></span>;
<span class="fn">let <span class="fn">neuron_pmf</span> := <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">p</span> <span class="fn">⋯</span></span>;
<span class="fn"><span class="fn">neuron_pmf</span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span></span></span></div></div><p>The probability of selecting a specific neuron in the uniform distribution is 1/|U| -</p></div></div><div class="decl" id="gibbs_update_zero_other_sites"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1410-L1447">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_update_zero_other_sites"><span class="name">gibbs_update_zero_other_sites</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u </span><span class="fn">v</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">w</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">w</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">w</span></span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_diff</span> : <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s'</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">0</span></span></div></div><p>When states differ at site u, the probability of transitioning to s' by updating
any other site v is zero -</p></div></div><div class="decl" id="gibbs_transition_sum_simplification"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1449-L1477">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_transition_sum_simplification"><span class="name">gibbs_transition_sum_simplification</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h</span> : <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_diff</span> : <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">neuron_pmf</span> := <span class="fn"><a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">U</span>) =&gt; <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span>)</span> <span class="fn">⋯</span></span>;
<span class="fn">let <span class="fn">update_prob</span> := <span class="fn">fun (<span class="fn">v</span> : <span class="fn">U</span>) =&gt; <span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s'</span></span></span>;
<span class="fn">∑ <span class="fn">v</span> : <span class="fn">U</span>, <span class="fn"><span class="fn">neuron_pmf</span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn">update_prob</span> <span class="fn">v</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">neuron_pmf</span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn">update_prob</span> <span class="fn">u</span></span></span></span></div></div><p>When calculating the transition probability sum, only the term for the
differing site contributes -</p></div></div><div class="decl" id="single_site_difference_as_update"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1479-L1498">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#single_site_difference_as_update"><span class="name">single_site_difference_as_update</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">s </span><span class="fn">s'</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_diff_at_u</span> : <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">h_same_elsewhere</span> : <span class="fn">∀ (<span class="fn">v</span> : <span class="fn">U</span>), <span class="fn"><span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span> → <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">s'</span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><a href=".././HopfieldNet/Stochastic.html#NN.State.updateNeuron">NN.State.updateNeuron</a> <span class="fn">s</span> <span class="fn">u</span> <span class="fn">(<span class="fn"><span class="fn">s'</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span>)</span> <span class="fn">⋯</span></span></div></div><p>When states differ at exactly one site, the later state can be expressed as
an update of the first state at that site -</p></div></div><div class="decl" id="gibbs_update_preserves_other_sites"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1500-L1519">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#gibbs_update_preserves_other_sites"><span class="name">gibbs_update_preserves_other_sites</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">wθ</span> : <span class="fn"><a href=".././HopfieldNet/NN.html#Params">Params</a> <span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">T</span> : <a href=".././Mathlib/Data/Real/Basic.html#Real">ℝ</a>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">v </span><span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">hvu</span> : <span class="fn">v</span> <a href=".././Init/Core.html#Ne">≠</a> <span class="fn">u</span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s_next</span> : <span class="fn"><span class="fn">(<a href=".././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn"><span class="fn">(<a href=".././HopfieldNet/Stochastic.html#NN.State.gibbsUpdateSingleNeuron">NN.State.gibbsUpdateSingleNeuron</a> <span class="fn">s</span> <span class="fn">wθ</span> <span class="fn">T</span> <span class="fn">v</span>)</span> <span class="fn">s_next</span></span> <a href=".././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span> → <span class="fn"><span class="fn"><span class="fn">s_next</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href=".././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span></span></div></div></div></div><div class="decl" id="uniform_neuron_prob"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1521-L1539">source</a></div><div class="attributes">@[simp]</div>
<div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#uniform_neuron_prob"><span class="name">uniform_neuron_prob</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<a href=".././Mathlib/Probability/ProbabilityMassFunction/Constructions.html#PMF.ofFintype">PMF.ofFintype</a> <span class="fn">(fun (<span class="fn">x</span> : <span class="fn">U</span>) =&gt; <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span>)</span> <span class="fn">⋯</span>)</span> <span class="fn">u</span></span></div></div></div></div><div class="decl" id="uniform_neuron_selection_prob_valid"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/307f1b2e6f4c9c608c25d82d5895358e7015f373/HopfieldNet/Stochastic.lean#L1541-L1555">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href=".././HopfieldNet/Stochastic.html#uniform_neuron_selection_prob_valid"><span class="name">uniform_neuron_selection_prob_valid</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">U</span> : <a href=".././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href=".././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">let <span class="fn">p</span> := <span class="fn">fun (<span class="fn">x</span> : <span class="fn">U</span>) =&gt; <span class="fn">1</span> <a href=".././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn">↑<span class="fn">(<a href=".././Mathlib/Data/Fintype/Card.html#Fintype.card">Fintype.card</a> <span class="fn">U</span>)</span></span></span>;
<span class="fn">∑ <span class="fn">a</span> : <span class="fn">U</span>, <span class="fn"><span class="fn">p</span> <span class="fn">a</span></span></span> <a href=".././Init/Prelude.html#Eq">=</a> <span class="fn">1</span></span></div></div><p>Uniform neuron selection gives a valid PMF -</p></div></div></main>
<nav class="nav"><iframe src=".././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>